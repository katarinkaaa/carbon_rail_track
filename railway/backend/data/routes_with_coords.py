# backend/data/routes_with_coords.py
import math

# === МАРШРУТЫ ===
ROUTES = {
    "1": {
        "name": "WB транзит Достык",
        "stations": [
            "Достык (эксп.)", "Достык", "Бесколь", "Предузловая", "Саяк", "Балхаш II", "Балхаш I",
            "Кокдомбак", "Сарыкум", "Буйрек (рзд)", "Мойынты", "Акадыр", "Кулайгыр", "Карабас", "Караганда-Сортировочная",
            "Нура", "Мырза", "Сороковая", "Астана-1", "Атбасар", "Перекатная", "Жаксы", "Красивый-казахский", "Есиль",
            "Сурган", "Ковыльная I", "Жанысбай", "Челгаши", "Обг. Пункт № 75", "Койбагор", "Кушмурун", "Аманкарагай",
            "Казанбасы", "Апановка", "Притобольская", "Тобол", "Баталы", "Зааятская", "Елимай (обп)", "Карталы I",
            "Знойное (обп)", "Гогино", "Байтук", "Айдырля", "Шильда", "Теренсай", "Обг. Пункт 216 км", "Новоорск",
            "Кумацкая", "Орск", "Круторожино", "Разъезд № 213-а", "Халилово", "Сара", "Кувандык", "Дубиновка",
            "Кандуровка", "Черный Отрог", "Чебеньки", "Обг. Пункт № 202", "Сакмарская", "Обг. Пункт № 201", "Оренбург",
            "Каргала", "Сырт", "Переволоцкая", "Платовка", "Новосергиевская", "Гамалеевка", "Погромное", "Елшанка",
            "Колтубанка", "Неприк", "Заливная", "Богатое", "Грачевка", "Спиридоновка", "Кинель", "Алексеевская",
            "Безымянка", "Кряж", "Новокуйбышевская", "Безенчук", "Правая волга", "Сызрань I", "Сызрань II", "Новообразцовое",
            "Инза", "Зыково (обп)", "Рузаевка", "Пишля (обп)", "Потьма", "Пичкиряево", "Берестянки", "Сасово", "Сотницыно",
            "Чучково", "Назаровка", "Ушинский", "Шилово", "Шелухово", "Новая Пустынь", "Проня", "Перевлес", "Листвянка",
            "Лесок", "Рязань I", "Дягилево", "Рыбное", "Дивово", "Алпатьево", "Фруктовая", "Подлипки", "Луховицы", "Щурово",
            "Голутвин", "Пески", "Шиферная", "Непецино", "Детково", "Сандарово", "Кресты", "Бекасово-сортировочное",
            "Пожитково", "214 КМ", "Кубинка I", "Тучково", "Дорохово", "Можайск", "Туманово", "Мещерская", "Вязьма",
            "Милохово", "Ярцево", "Кардымово", "Духовская", "Смоленск", "Красный бор", "ОП Ракитная", "Гусино",
            "Орша-центральная", "Борисов", "Степянка", "Минск-сортировочный", "Негорелое-стык", "Барановичи-центральные",
            "Лесная-стык", "Ивацевичи", "Бронная гора", "Береза Картузская", "Оранчицы", "Жабинка", "Брест-восточный"
        ]
    },
    "2": {
        "name": "EB транзит Достык",
        "stations": [
            "Брест-северный", "Брест-восточный", "Жабинка", "Оранчицы", "Береза Картузская",
            "Бронная гора", "Ивацевичи", "Доманово", "Лесная-стык", "Барановичи-центральные", "Негорелое-стык",
            "Минск-сортировочный", "Степянка", "Борисов", "Гусино", "Гнездово", "Смоленск", "Смоленск-сортировочный",
            "Духовская", "Кардымово", "Ярцево", "Милохово", "Сафоново", "Издешково", "Вязьма", "Туманово", "Можайск",
            "Дорохово", "Тучково", "Кубинка I", "214 КМ", "Пожитково", "Бекасово I", "Бекасово-сортировочное", "Кресты",
            "Сандарово", "Детково", "Ступино", "Ожерелье", "Пурлово", "Богатищево", "Узуново", "Рыбное", "Дягилево",
            "Рязань I", "Лесок", "Листвянка", "Перевлес", "Проня", "Новая Пустынь", "Шелухово", "Шилово", "Ушинский",
            "Назаровка", "Чучково", "Сотницыно", "Сасово", "Берестянки", "Пичкиряево", "Потьма", "Пишля (обп)", "Рузаевка",
            "Зыково (обп)", "Сура", "Инза", "Новообразцовое", "Сызрань II", "Сызрань I", "Правая волга", "Безенчук",
            "Новокуйбышевская", "Кряж", "Алексеевская", "Спиридоновка", "Грачевка", "Богатое", "Заливная", "Неприк",
            "Колтубанка", "Елшанка", "Бузулук", "Погромное", "Гамалеевка", "Новосергиевская", "Платовка", "Переволоцкая",
            "Сырт", "Оренбург", "Обг. Пункт № 201", "Сакмарская", "Обг. Пункт № 202", "Чебеньки", "Черный Отрог",
            "Кандуровка", "Дубиновка", "Кувандык", "Сара", "Халилово", "Разъезд № 213-а", "Круторожино", "Никель",
            "Орск", "Кумацкая", "Новоорск", "Обг. Пункт 216 км", "Теренсай", "Шильда", "Айдырля", "Байтук", "Гогино",
            "Знойное (обп)", "Елимай (обп)", "Зааятская", "Баталы", "Тобол", "Притобольская", "Апановка", "Казанбасы",
            "Аманкарагай", "Кушмурун", "Койбагор", "Обг. Пункт № 75", "Челгаши", "Жанысбай", "Ковыльная I", "Сурган",
            "Есиль", "Красивый-казахский", "Жаксы", "Перекатная", "Оп № 86", "Атбасар", "Астана-1", "Сороковая",
            "Мырза", "Нура", "Караганда-Сортировочная", "Карабас", "Кулайгыр", "Жарык", "Акадыр", "Мойынты", "Буйрек (рзд)",
            "Кокдомбак", "Балхаш I", "Балхаш II", "Саяк", "Предузловая", "Актогай-Восточный (рзд)", "Разъезд № 8",
            "Бесколь", "Достык (эксп.)"
        ]
    },
    "3": {
        "name": "WB транзит Алтынколь",
        "stations": [
            "Алтынколь", "Шелек", "Жетыген", "Алматы 1", "Отар", "Шу", "Турксиб", "Тараз", "Тюлькубас",
            "Шымкент", "Бадам", "Арыс 1", "Туркестан", "Шиели", "Кызылорда", "Караозек", "Теренозек", "Жалагаш", "Каракеткен",
            "Кызылтам", "Жосалы", "Казалы", "Сексеул", "Шалкар", "Жем", "Кандыагаш", "Актобе I", "Жайсан", "Канисай (рзд)",
            "Меновой Двор", "Меновой Двор", "Оренбург", "Оренбург", "Сырт", "Переволоцкая", "Переволоцкая", "Платовка",
            "Новосергиевская", "Новосергиевская", "Гамалеевка", "Гамалеевка", "Погромное", "Погромное", "Елшанка", "Колтубанка",
            "Колтубанка", "Неприк", "Неприк", "Заливная", "Богатое", "Грачевка", "Кинель", "Кинель", "Алексеевская", "Алексеевская",
            "Безымянка", "Безымянка", "Кряж", "Безенчук", "Правая волга", "Сызрань I", "Сызрань II", "Новообразцовое", "Инза",
            "Инза", "Зыково (обп)", "Рузаевка", "Пишля (обп)", "Потьма", "Пичкиряево", "Пичкиряево", "Берестянки", "Сасово",
            "Сотницыно", "Сотницыно", "Чучково", "Назаровка", "Назаровка", "Ушинский", "Ушинский", "Шилово", "Шилово", "Шелухово",
            "Шелухово", "Новая Пустынь", "Новая Пустынь", "Проня", "Проня", "Перевлес", "Перевлес", "Листвянка", "Листвянка",
            "Лесок", "Лесок", "Рязань I", "Рязань I", "Дягилево", "Дягилево", "Рыбное", "Рыбное", "Дивово", "Дивово", "Алпатьево",
            "Алпатьево", "Фруктовая", "Подлипки", "Подлипки", "Луховицы", "Луховицы", "Щурово", "Голутвин", "Пески", "Шиферная",
            "Шиферная", "Непецино", "Непецино", "Детково", "Сандарово", "Сандарово", "Кресты", "Кресты", "Пожитково", "Пожитково",
            "214 КМ", "Кубинка I", "Кубинка I", "Тучково", "Дорохово", "Дорохово", "Можайск", "Туманово", "Мещерская", "Мещерская",
            "Вязьма", "Вязьма", "Гусино", "Орша-центральная", "Борисов", "Степянка", "Минск-сортировочный", "Негорелое-стык",
            "Барановичи-центральные", "Лесная-стык", "Ивацевичи", "Бронная гора", "Береза Картузская", "Оранчицы", "Жабинка", "Брест-восточный"
        ]
    },
    "4": {
        "name": "EB транзит Алтынколь",
        "stations": [
            "Брест-северный", "Брест-восточный", "Жабинка", "Оранчицы", "Береза Картузская",
            "Бронная гора", "Ивацевичи", "Лесная-стык", "Барановичи-центральные", "Негорелое-стык", "Минск-сортировочный",
            "Степянка", "Борисов", "Гусино", "Гнездово", "Смоленск", "Смоленск-сортировочный", "Духовская", "Кардымово",
            "Ярцево", "Милохово", "Сафоново", "Издешково", "Вязьма", "Мещерская", "Туманово", "Можайск", "Дорохово", "Тучково",
            "Кубинка I", "214 КМ", "Пожитково", "Бекасово I", "Бекасово-сортировочное", "Кресты", "Сандарово", "Детково",
            "Ступино", "Ожерелье", "Пурлово", "Богатищево", "Узуново", "Рыбное", "Дягилево", "Рязань I", "Лесок", "Листвянка",
            "Перевлес", "Проня", "Новая Пустынь", "Шелухово", "Шилово", "Ушинский", "Назаровка", "Чучково", "Сотницыно",
            "Сасово", "Берестянки", "Пичкиряево", "Потьма", "Пишля (обп)", "Рузаевка", "Зыково (обп)", "Инза", "Новообразцовое",
            "Сызрань II", "Сызрань I", "Правая волга", "Безенчук", "Новокуйбышевская", "Кряж", "Безымянка", "Алексеевская",
            "Спиридоновка", "Грачевка", "Богатое", "Заливная", "Неприк", "Колтубанка", "Елшанка", "Погромное", "Гамалеевка",
            "Новосергиевская", "Платовка", "Переволоцкая", "Сырт", "Оренбург", "Меновой Двор", "Илецк I", "Жайсан",
            "Кызгалдакты", "Актобе I", "Кандыагаш", "Жем", "Шалкар", "Сексеул", "Казалы", "Жосалы", "Кызылтам", "Каракеткен",
            "Жалагаш", "Теренозек", "Караозек", "Кызылорда", "Шиели", "Туркестан", "Арыс 1", "Шымкент", "Тюлькубас", "Тараз",
            "Турксиб", "Шу", "Отар", "Бурундай", "Алматы 1", "Жетыген", "Шелек", "Алтынколь (эксп.)"
        ]
    }
}

# === КООРДИНАТЫ ===
COORDINATES = {
    "Достык (эксп.)": (45.256062, 82.492783),
    "Кардымово": (54.8898976, 32.435973),
    "Духовская": (54.798306, 32.289936),
    "Смоленск-сортировочный": (54.8108278, 32.1241352),
    "Гусино": (54.725387, 31.369076),
    "Борисов": (54.221163, 28.512931),
    "Алтынколь (эксп.)": (44.1647635, 80.2952521),
    "Бурундай": (43.3584693, 76.8590468),
    "Кызгалдакты": (50.3971989, 57.0688585),
    "Непецино": (55.2006405, 38.6079795),
    "Шиферная": (55.2831279, 38.7364654),
    "Ярцево": (55.0662279, 32.6883609),
    "Пески": (55.214882, 38.77193),
    "Щурово": (54.98, 39.03),
    "Луховицы": (54.9655573, 39.0277188),
    "Подлипки": (54.956246053, 39.175404921),
    "Фруктовая": (54.9148794, 39.254995),
    "Алпатьево": (54.8816833, 39.3231799),
    "Дивово": (54.7941174, 39.4278691),
    "Пичкиряево": (54.202644, 42.456608),
    "Потьма": (54.1164028, 42.9051557),
    "Пишля (обп)": (54.063457, 44.8985904),
    "Рузаевка": (54.058735, 44.954391),
    "Голутвин": (55.0861808, 38.8052754),
    "Милохово": (55.0691781, 32.7824283),
    "Сафоново": (55.1084278, 33.2376513),
    "Издешково": (55.143578, 33.621201),
    "Детково": (55.218135, 37.519281),
    "Сандарово": (55.250178, 37.4484938),
    "Кресты": (55.2759456, 37.1040732),
    "Бекасово-сортировочное": (55.4186086, 36.8716977),
    "Бекасово I": (55.4296452, 36.8401684),
    "Пожитково": (55.4203792, 36.8186016),
    "214 КМ": (55.5369689, 36.6648197),
    "Кубинка I": (55.5791251, 36.690883),
    "Тучково": (55.6014428, 36.4662973),
    "Дорохово": (55.54671, 36.371941),
    "Туманово": (55.42551422, 34.64416122),
    "Мещерская": (55.34813, 34.453796),
    "Вязьма": (55.2103563, 34.2995187),
    "Зыково (обп)": (54.062569351, 45.091650076),
    "Рыбное": (54.730757, 39.5056425),
    "Инза": (53.8579402, 46.3573236),
    "Сызрань II": (53.1675288, 48.4386568),
    "Шу": (44.2584804, 73.0064021),
    "Отар": (43.5361304, 75.2160251),
    "Алматы 1": (43.3414234, 76.9492178),
    "Жетыген": (43.68869781, 77.12618256),
    "Шелек": (43.0734948, 78.3754413),
    "Алтынколь": (44.1647635, 80.2952521),
    "Разъезд № 8": (46.328668, 80.828656),
    "Актогай-Восточный (рзд)": (46.9006312, 79.6925758),
    "Карабас": (49.574913, 72.892508),
    "Нура": (50.147249, 73.174690),
    "Турксиб": (42.8292785, 71.3999223),
    "Сороковая": (51.14352036, 71.56267548),
    "Оп № 86": (51.77530874, 68.20792783),
    "Перекатная": (51.83089066, 67.92379761),
    "Есиль": (51.955622, 66.402481),
    "Ковыльная I": (52.04029648, 66.05162859),
    "Орша-центральная": (54.523592, 30.34121),
    "Притобольская": (52.62627792, 62.77217865),
    "Тобол": (52.69497, 62.583173),
    "Баталы": (52.841947761, 62.008488681),
    "Никель": (51.24829483, 58.56459808),
    "Сакмарская": (51.95453, 55.3696688),
    "Астана-1": (51.1957, 71.4091),
    "Тараз": (42.8774419, 71.3515681),
    "Тюлькубас": (42.488754, 70.286255),
    "Шымкент": (42.2944108, 69.6380923),
    "Сызрань I": (53.170231, 48.4820428),
    "Безымянка": (53.204762, 50.246143),
    "Кинель": (53.219738, 50.633228),
    "Меновой Двор": (51.7071949, 55.027801),
    "Канисай (рзд)": (51.2141697, 54.9094261),
    "Жайсан": (50.846708, 56.208099),
    "Актобе I": (50.3003589, 57.1545752),
    "Кандыагаш": (49.4718361, 57.4224647),
    "Жем": (48.5083642, 57.4452184),
    "Шалкар": (47.8273018, 59.6159216),
    "Сексеул": (47.0840304, 61.1544583),
    "Казалы": (45.76255, 62.101181),
    "Жосалы": (45.484024, 64.0849),
    "Кызылтам": (45.31596, 64.345993),
    "Каракеткен": (45.1913039, 64.5142304),
    "Жалагаш": (45.0772638, 64.6758422),
    "Теренозек": (45.056285, 64.988403),
    "Караозек": (44.997521, 65.278178),
    "Кызылорда": (44.8426778, 65.5036151),
    "Шиели": (44.180459, 66.736974),
    "Туркестан": (43.3019457, 68.2703698),
    "Арыс 1": (42.4192174, 68.7937581),
    "Бадам": (42.284161, 69.5904403),
    "Новообразцовое": (53.1649358, 48.3590097),
    "Оренбург": (51.7671248, 55.0978517),
    "Дягилево": (54.6438076, 39.5729428),
    "Лесок": (54.585834, 39.794446),
    "Балхаш II": (46.8561998, 74.9871853),
    "Балхаш I": (46.858888, 74.9865),
    "Кокдомбак": (46.904278, 74.4676065),
    "Сарыкум": (46.9733003, 74.1359899),
    "Буйрек (рзд)": (47.1322659, 73.7088081),
    "Мойынты": (47.216271, 73.0948949),
    "Науалы": (47.0014928, 81.7500614),
    "Шыганак": (45.1064432, 73.975037),
    "Саяк": (47.0, 78.583333),
    "Предузловая": (46.903222882, 79.460871220),
    "Бесколь": (46.172704,  81.096591),
    "Красный бор": (54.800117, 31.903409),
    "Смоленск": (54.7814057, 32.0461261),
    "Уваровка": (55.5301214, 35.6068561),
    "Можайск": (55.506478, 36.0213092),
    "Ступино": (54.886598, 38.0772589),
    "Ожерелье": (54.8029359, 38.2738244),
    "Пурлово": (54.7319833, 38.3835719),
    "Узуново": (54.5450963, 38.6201014),
    "Воденяпинский": (54.071413, 43.4510918),
    "Вырыпаевка (обп)": (53.7992722, 46.5016521),
    "Спиридоновка": (53.192792, 50.778475),
    "Маячная": (51.326272, 54.9548813),
    "Акмая (рзд)": (44.08987, 66.865723),
    "Жайпак (рзд)": (46.018372, 81.274925),
    "Рязань I": (54.63370132, 39.71336746),
    "Тогыз": (47.5570671, 60.5419636),
    "Правая волга": (53.18479, 48.7798164),
    "Чаис": (53.8758877, 45.9055596),
    "Безенчук": (52.985322, 49.4322968),
    "Берестянки": (54.33445, 41.978062),
    "Сотницыно": (54.2759036, 41.7969637),
    "Чучково": (54.282145306, 41.432512477),
    "Назаровка": (54.30114, 41.297215 ),
    "Ушинский": (54.334514, 41.149195),
    "Шилово": (54.320775, 40.888281),
    "Шелухово": (54.2864329, 40.5408354),
    "Новая Пустынь": (54.2340929, 40.493371),
    "Проня": (54.29806137, 40.24344254),
    "Перевлес": (54.256165, 40.197395),
    "Листвянка": (54.511421, 39.975387),
    "Сасово": (54.3448388, 41.9215119),
    "Новокуйбышевская": (53.1152884, 49.8976075),
    "Кряж": (53.121794, 50.077322),
    "Разъезд № 20": (51.5937292, 55.0347046),
    "Сырт": (51.873665, 54.525955),
    "Переволоцкая": (51.8751214, 54.1833162),
    "Платовка": (51.9723765, 53.9109637),
    "Новосергиевская": (52.082155, 53.643903),
    "Гамалеевка": (52.2745456, 53.4523251),
    "Погромное": (52.616427, 52.492587),
    "Красногвардеец II": (52.677895, 52.369648),
    "Елшанка": (52.8354791, 52.1298542),
    "Колтубанка": (52.935, 51.9074),
    "Неприк": (53.1221456, 51.8473971),
    "Заливная": (53.0628643, 51.4503704),
    "Богатое": (53.057625, 51.333107),
    "Грачевка": (53.12067032, 51.08434677),
    "Алексеевская": (53.23580551,  50.48682022),
    "Шабаны": (57.437717, 28.166105),
    "Каргала": (51.886717, 54.848933),
    "Сурган": (52.0005406, 66.2553111),
    "Красивый-казахский": (51.892647, 66.7506745),
    "Жаксы": (51.908749, 67.31617),
    "Атбасар": (51.8099624, 68.3584729),
    "Мырза": (50.204844, 73.088189),
    "Караганда-Сортировочная": (49.970186, 73.2227385),
    "Кулайгыр": (49.426928, 72.9235554),
    "Акадыр": (48.261346, 72.859182),
    "Достык": (45.256062, 82.492783),
    "Челгаши": (52.138184, 65.650726),
    "Койбагор": (52.29240417, 65.01554871),
    "Кушмурун": (52.4487666, 64.6146885),
    "Аманкарагай": (52.4019495, 64.0878685),
    "Чебеньки": (51.9336509, 55.7077243),
    "Черный Отрог": (51.8867425, 55.9995727),
    "Кандуровка": (51.5193609, 56.6898863),
    "Дубиновка": (51.527366, 56.842752),
    "Кувандык": (51.478756, 57.350796),
    "Сара": (51.4660529, 57.9168003),
    "Халилово": (51.398282, 58.128557),
    "Разъезд № 213-а": (51.2791466, 58.2678114),
    "Круторожино": (51.2862688, 58.4301396),
    "Орск": (51.21370697, 58.6195488),
    "Кумацкая": (51.3150583, 58.8793101),
    "Новоорск": (51.3812897, 58.9857207),
    "Теренсай": (51.589283, 59.50824),
    "Айдырля": (52.0386257, 59.7999234),
    "Байтук": (52.0976146, 59.9978687),
    "Гогино": (52.707684, 60.497341),
    "Знойное (обп)": (52.9771243, 60.629666),
    "Карталы I": (53.0532288, 60.6426992),
    "Елимай (обп)": (52.980689, 61.176768),
    "Зааятская": (52.892086, 61.577431),
    "Апановка": (52.541523, 63.200439),
    "Казанбасы": (52.462803, 63.639256),
    "Шильда": (51.8149002, 59.7749981),
    "Богатищево": (54.678619 , 38.529416 ),
    "Сура": (54.1731507, 46.0259618),
    "Гнездово": (54.78178787, 31.83581352),
    "Доманово": (52.828730637, 25.474162102),
    "Бронная гора": (52.60677719, 25.09271622),
    "Жабинка": (52.20091248, 24.01716042),
    "Бузулук": (52.7586837, 52.2883167),
    "Жанысбай": (52.084134466, 65.84798187),
    "ОП Ракитная": (54.79536438, 31.82115555),
    "Обг. Пункт № 75": (52.2343, 65.234474),
    "Обг. Пункт № 201": (51.95265, 55.35485),
    "Илецк I": (51.171194, 54.985952),
    "Степянка": (53.914803, 27.663085),
    "Минск-сортировочный": (53.879735, 27.530753),
    "Негорелое-стык": (53.59866, 27.063979),
    "Барановичи-центральные": (53.129402, 25.988511),
    "Лесная-стык": (52.990571, 25.77862),
    "Ивацевичи": (52.709, 25.3401),
    "Береза Картузская": (52.53295517, 24.89940071),
    "Брест-восточный": (52.109547, 23.724504),
    "Оранчицы": (52.47049713, 24.52301598),
    "Обг. Пункт № 202": (51.9583168, 55.52490234),
    "Обг. Пункт 216 км": (51.407074, 59.148344),
    "Жарык": (48.856215, 72.83145),
    "Сары-Шаган": (46.119208, 73.60541),
    "Брест-северный": (52.11133575, 23.65402031),
    "Колядичи": (53.808229, 27.579393),
}

# === ХЕЛПЕРЫ ===
def clean_route(route_list):
    cleaned = []
    for s in route_list:
        if not cleaned or cleaned[-1] != s:
            cleaned.append(s)
    return cleaned

def haversine(lat1, lon1, lat2, lon2):
    R = 6371.0
    lat1, lon1, lat2, lon2 = map(math.radians, [lat1, lon1, lat2, lon2])
    dlat = lat2 - lat1
    dlon = lon2 - lon1
    a = math.sin(dlat/2)**2 + math.cos(lat1) * math.cos(lat2) * math.sin(dlon/2)**2
    c = 2 * math.atan2(math.sqrt(a), math.sqrt(1 - a))
    return R * c

# === ОЧИСТКА маршрутов от дублей ===
for key in ROUTES:
    ROUTES[key]["stations"] = clean_route(ROUTES[key]["stations"])